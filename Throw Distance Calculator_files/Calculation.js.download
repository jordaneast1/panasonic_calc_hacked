var Calculation = function () {
    var g = null, hb = function () { }, d = hb.prototype; d.CalcLink = function (a) { g = a }; d.CalcScreenSizeWidthFromScreenSizeDiagonal = function (a, b, c) { return b * a / Math.sqrt(b * b + c * c) }; d.CalcScreenSizeHeightFromScreenSizeDiagonal = function (a, b, c) { return c * a / Math.sqrt(b * b + c * c) }; d.CalcScreenSizeHeightFromScreenSizeWidth = function (a, b, c) { return a / b * c }; d.CalcScreenSizeWidthFromScreenSizeHeight = function (a, b, c) { return a / c * b }; d.CalcScreenSizeDiagonalFromScreenSizeWidthAndHeight = function (a, b) {
        return Math.sqrt(a *
            a + b * b)
    }; d.CalcDistanceToScreenFromDiagonal = function (a, b, c) { return b * a + c }; d.CalcDiagonalFromDiatanceToScreen = function (a, b, c) { return (a - c) / b }; d.CalcScreenUpperLeftCorner = function (a, b, c, k, h) { c = d.CalcDiagonalFromDiatanceToScreen(a, b, c); b = d.CalcScreenSizeWidthFromScreenSizeDiagonal(c, k, h); k = d.CalcScreenSizeHeightFromScreenSizeDiagonal(c, k, h); ptZ = a; return { x: -.5 * b, y: .5 * k, z: ptZ } }; d.CalcThrowRatioFromDistanceToScreenAndScreenWidth = function (a, b) { return a / b }; d.ConvFromInchToMeter = function (a) { return .0254 * a }; d.ConvFromFeetToMeter =
        function (a) { return .3048 * a }; d.ConvFromFeetToInch = function (a) { return 12 * a }; d.ConvFromInchToFeet = function (a) { return .0833333 * a }; d.ConvFromMeterToInch = function (a) { return 39.3700787 * a }; d.ConvFromMeterToFeet = function (a) { return 3.2808399 * a }; d.ConvParameterValueFromInchToSelectUnit = function (a) { var b, c = $('input[name="radio_unit"]:checked').val(); "m" == c ? b = d.ConvFromInchToMeter(a) : "ft" == c ? b = d.ConvFromInchToFeet(a) : "inch" == c && (b = a); return b }; d.ConvParameterValueFromSelectUnitToMeter = function (a) {
            var b, c = $('input[name="radio_unit"]:checked').val();
            "m" == c ? b = a : "ft" == c ? b = d.ConvFromFeetToMeter(a) : "inch" == c && (b = d.ConvFromInchToMeter(a)); return b
        }; d.ConvParameterValueFromMeterToSelectUnit = function (a) { var b, c = $('input[name="radio_unit"]:checked').val(); "m" == c ? b = a : "ft" == c ? b = d.ConvFromMeterToFeet(a) : "inch" == c && (b = d.ConvFromMeterToInch(a)); return b }; d.ConvParameterValueFromFeetToSelectUnit = function (a) { var b, c = $('input[name="radio_unit"]:checked').val(); "m" == c ? b = d.ConvFromFeetToMeter(a) : "ft" == c ? b = a : "inch" == c && (b = d.ConvFromFeetToInch(a)); return b }; d.CalcRoundBySelectUnit =
            function (a, b, c) { var k = 0, h = 0, e = $('input[name="radio_unit"]:checked').val(); "m" == e ? h = c.m : "inch" == e ? h = c.inch : "ft" == e && (h = c.ft); a == ROUNDING_TYPE.string ? k = b.toFixed(h) : a == ROUNDING_TYPE.number && (k = d.CalcRound(b, h)); return k }; d.CalcRound = function (a, b) { b = Math.pow(10, b); a = Math.round(a * b); return a /= b }; d.CalcRotationZXY = function (a, b, c, k, h, e) { k *= Math.PI / 180; h *= Math.PI / 180; a = d.CalcRotationZ(a, b, c, Math.PI / 180 * e); a = d.CalcRotationX(a.x, a.y, a.z, k); a = d.CalcRotationY(a.x, a.y, a.z, h); return { x: a.x, y: a.y, z: a.z } }; d.CalcRotationX =
                function (a, b, c, k) { return { x: a, y: Math.cos(k) * b - Math.sin(k) * c, z: Math.sin(k) * b + Math.cos(k) * c } }; d.CalcRotationY = function (a, b, c, k) { return { x: Math.cos(k) * a - Math.sin(k) * c, y: b, z: Math.sin(k) * a + Math.cos(k) * c } }; d.CalcRotationZ = function (a, b, c, k) { return { x: Math.cos(-1 * k) * a - Math.sin(-1 * k) * b, y: Math.sin(-1 * k) * a + Math.cos(-1 * k) * b, z: c } }; d.DrawCalculation = function () {
                    var a = g.GetParamABTele(), b = g.GetParamABWide(), c = g.GetNativeParamABTele(), k = g.GetNativeParamABWide(), h = g.GetNativeAspect(), e = g.GetUserAspect(), x = g.GetLensShift(),
                    p = g.GetPjRot(), f = g.GetPjOrigin(), q = g.GetInitPjBody(), B = g.GetRoomLength(), w = g.GetRoomWidth(), t = g.GetRoomHeight(), u = g.GetScreenCurved(), r = g.GetLensShiftPolygon(), G = g.GetLensShiftVp(), n = g.GetLensShiftOffsetV(), X = k.A, F = k.B, I = c.A, Y = c.B, v = h.w, hb = h.h, sb = e.w, tb = e.h, ba = 1; if ($("#lock_size").prop("checked") && X != I && F != Y) {
                        var Ub = g.GetWideScreenSize().diagonal / d.CalcPanelDiagRatioByUserAspect(v, hb, sb, tb), Rc = g.GetPjOrigin().z, Vb = d.CalcDistanceToScreenFromDiagonal(Ub, X, F), Sc = d.CalcDistanceToScreenFromDiagonal(Ub,
                            I, Y); ba = 1 - (Rc - Vb) / (Sc - Vb); 0 > ba && (ba = 0); 1 < ba && (ba = 1)
                    } var Wa = X * ba + I * (1 - ba); var Ba = F * ba + Y * (1 - ba); g.SetParamABZoom(Wa, Ba); if (!$("#lock_size").prop("checked")) {
                        var sa = Wb(f.z, b.A, b.B, e.w, e.h); var Tc = d.CalcDistanceToScreenFromDiagonal(sa.diagonal, a.A, a.B); var Ka = { min: f.z, max: Tc }, Ca = Wb(Ka.min, a.A, a.B, e.w, e.h), ta = g.GetMinMaxDiagonalTele(), Xb = d.CalcScreenSizeWidthFromScreenSizeDiagonal(ta.min, e.w, e.h), Yb = d.CalcScreenSizeHeightFromScreenSizeDiagonal(ta.min, e.w, e.h), Zb = d.CalcDistanceToScreenFromDiagonal(ta.min,
                            a.A, a.B); d.CalcScreenSizeWidthFromScreenSizeDiagonal(ta.max, e.w, e.h); d.CalcScreenSizeHeightFromScreenSizeDiagonal(ta.max, e.w, e.h); d.CalcDistanceToScreenFromDiagonal(ta.max, a.A, a.B); var ua = g.GetMinMaxDiagonalTele(), $b = d.CalcScreenSizeWidthFromScreenSizeDiagonal(ua.min, e.w, e.h), ac = d.CalcScreenSizeHeightFromScreenSizeDiagonal(ua.min, e.w, e.h), ib = d.CalcDistanceToScreenFromDiagonal(ua.min, b.A, b.B); d.CalcScreenSizeWidthFromScreenSizeDiagonal(ua.max, e.w, e.h); d.CalcScreenSizeHeightFromScreenSizeDiagonal(ua.max,
                                e.w, e.h); d.CalcDistanceToScreenFromDiagonal(ua.max, b.A, b.B);/* LIMITS DISABLED - Ca.diagonal<ta.min&&(Ca.diagonal=ta.min);Ca.width<Xb&&(Ca.width=Xb);Ca.height<Yb&&(Ca.height=Yb);Ka.max<Zb&&(Ka.max=Zb);sa.diagonal<ua.min&&(sa.diagonal=ua.min);sa.width<$b&&(sa.width=$b);sa.height<ac&&(sa.height=ac);Ka.min<ib&&(Ka.min=ib,f.z=ib,g.SetPjOriginZ(ib)) */
                    } var bc = []; bc = cc(1E3, Wa, Ba, h.w, h.h, e.w, e.h, x.v, x.h, n, p.x, p.y, p.z, f.x, f.y, f.z); if (0 < r) {
                        var dc = []; dc = ec(1E3, Wa, Ba, h.w, h.h, e.w, e.h, p.x, p.y, p.z, f.x, f.y, f.z, r, G, n); var fc = []; fc = cc(1E3,
                            Wa, Ba, h.w, h.h, e.w, e.h, x.v, x.h, 0, 0, 0, 0, 0, 0, 0); var gc = []; gc = ec(1E3, Wa, Ba, h.w, h.h, e.w, e.h, 0, 0, 0, 0, 0, 0, r, G, 0); var jb = fc, Uc = gc, La = !1, va = []; va[0] = jb[1]; va[1] = jb[9]; va[2] = jb[17]; va[3] = jb[25]; for (var ca = [], M = 0; M < r; M++)ca[M] = Uc[32 * M], ca[M].x *= 1.0001, ca[M].y *= 1.0001; for (M = 0; M < r; M++) {
                                var kb = M + 1; kb == r && (kb = 0); for (var Xa = 0; 4 > Xa; Xa++) {
                                    var lb = Xa + 1; 4 == lb && (lb = 0); a: {
                                        var Ma = void 0, Na = void 0, Oa = void 0, Pa = void 0, wa = ca[M].x, xa = ca[M].y, Qa = ca[kb].x, Ra = ca[kb].y, da = va[Xa].x, ea = va[Xa].y, Da = va[lb].x, Ea = va[lb].y, hc = d.CalcRound((wa -
                                            Qa) * (ea - xa) + (xa - Ra) * (wa - da), 8), ic = d.CalcRound((wa - Qa) * (Ea - xa) + (xa - Ra) * (wa - Da), 8), jc = d.CalcRound((da - Da) * (xa - ea) + (ea - Ea) * (da - wa), 8), kc = d.CalcRound((da - Da) * (Ra - ea) + (ea - Ea) * (da - Qa), 8); if (0 == hc && 0 == ic && 0 == jc && 0 == kc) { if (da == Da && (xa < Ra ? (Pa = xa, Na = Ra) : (Pa = Ra, Na = xa), ea < Ea ? (Oa = ea, Ma = Ea) : (Oa = Ea, Ma = ea), Pa > Oa || Na < Ma)) { La = !0; break a } if (ea == Ea && (wa < Qa ? (Pa = wa, Na = Qa) : (Pa = Qa, Na = wa), da < Da ? (Oa = da, Ma = Da) : (Oa = Da, Ma = da), Pa > Oa || Na < Ma)) { La = !0; break a } } La = 0 > hc * ic && 0 > jc * kc ? !0 : !1
                                    } if (1 == La) break
                                } if (1 == La) break
                            } var Vc = La
                    } pjBodyPoint =
                        []; var Wc = p.x, Xc = p.y, Yc = p.z, Zc = f.x, $c = f.y, ad = f.z, J = [], bd = $("#model_name").val(); a: {
                            for (var cd = $("#lenses").val(), dd = $('input[name="radio_lang"]:checked').val(), mb, aa, ub = 0; 3 > ub; ub++) {
                                var lc = !1; switch (ub) {
                                    case 0: "undefined" != typeof RearProjPjBodyTable && (lc = !0, mb = RearProjPjBodyTable.length, aa = RearProjPjBodyTable); break; case 1: "undefined" != typeof LtypeProjPjBodyTable && (mb = LtypeProjPjBodyTable.length, aa = LtypeProjPjBodyTable); break; case 2: "undefined" != typeof FrontProjPjBodyTable && (mb = FrontProjPjBodyTable.length,
                                        aa = FrontProjPjBodyTable)
                                }if (1 == lc) for (var fa = 0; fa < mb; fa++)if (bd == aa[fa].ProjectorModelName[dd]) for (var Fa = 0, ed = aa[fa].Lens.length; Fa < ed; Fa++)if (cd == aa[fa].Lens[Fa].LensName) { for (var Sa = 0, fd = aa[fa].Lens[Fa].pjBody.length; Sa < fd; Sa++)J[Sa] = { x: aa[fa].Lens[Fa].pjBody[Sa].x, y: aa[fa].Lens[Fa].pjBody[Sa].y, z: aa[fa].Lens[Fa].pjBody[Sa].z }; var mc = !0; break a }
                            } mc = !1
                        } if (!mc) {
                            for (var E = 0; 8 > E; E++) { var vb = { x: q[E].x, y: q[E].y, z: q[E].z }; J[E] = vb } if (2E3 < B || 2E3 < w || 2E3 < t) {
                                var wb = t / 2E5 * 100; for (E = 0; 8 > E; E++)J[E].x *= wb, J[E].y *=
                                    wb, J[E].z *= wb
                            }
                        } for (E = 0; 8 > E; E++)vb = d.CalcRotationZXY(J[E].x, J[E].y, J[E].z, Wc, Xc, Yc), J[E] = vb, J[E].x += Zc, J[E].y += $c, J[E].z += ad; pjBodyPoint = J; var Ya = []; a: {
                            var R = [], nc = { x: 0, y: 0, z: 0 }, oc = { x: w, y: 0, z: 0 }, xb = { x: w, y: 0, z: B }, yb = { x: 0, y: 0, z: B }; if ($("#simulation_type").val() == SIMULATION_TYPE.HorizontalCurved && 0 != u) {
                                var zb = [], pc = { x: 0, y: 0 }, qc = { x: w / 2, y: -1 * u }, rc = { x: w, y: 0 }; var sc = d.CalcCircleBy3Point(pc, qc, rc); if (void 0 == sc) { R[0] = nc; R[1] = oc; R[2] = xb; R[3] = yb; Ya = R; break a } zb = tc(sc, pc, qc, rc, u); for (var Za = 0; 17 > Za; Za++)R[Za] =
                                    { x: zb[16 - Za].x, y: 0, z: zb[16 - Za].y }; R[17] = xb; R[18] = yb
                            } else R[0] = nc, R[1] = oc, R[2] = xb, R[3] = yb; Ya = R
                        } var Ab = [], uc = Ya, vc = [], wc = 4; $("#simulation_type").val() == SIMULATION_TYPE.HorizontalCurved && 0 != u && (wc = 19); for (var $a = 0; $a < wc; $a++)vc[$a] = { x: uc[$a].x, y: t, z: uc[$a].z }; Ab = vc; var ab = []; a: {
                            var S = [], xc = { x: 0, y: 0, z: 0 }, yc = { x: 0, y: t, z: 0 }, Bb = { x: 0, y: t, z: B }, Cb = { x: 0, y: 0, z: B }; if ($("#simulation_type").val() == SIMULATION_TYPE.VerticalCurved && 0 != u) {
                                var Db = [], zc = { x: 0, y: 0 }, Ac = { x: t / 2, y: -1 * u }, Bc = { x: t, y: 0 }; var Cc = d.CalcCircleBy3Point(zc,
                                    Ac, Bc); if (void 0 == Cc) { S[0] = xc; S[1] = yc; S[2] = Bb; S[3] = Cb; ab = S; break a } Db = tc(Cc, zc, Ac, Bc, u); for (var bb = 0; 17 > bb; bb++)S[bb] = { x: 0, y: Db[16 - bb].x, z: Db[16 - bb].y }; S[17] = Bb; S[18] = Cb
                            } else S[0] = xc, S[1] = yc, S[2] = Bb, S[3] = Cb; ab = S
                        } var Eb = [], Dc = ab, Ec = [], Fc = 4; $("#simulation_type").val() == SIMULATION_TYPE.VerticalCurved && 0 != u && (Fc = 19); for (var cb = 0; cb < Fc; cb++)Ec[cb] = { x: w, y: Dc[cb].y, z: Dc[cb].z }; Eb = Ec; var nb = [], ob = 1, db = [], Gc = $("#simulation_type").val(); if (Gc == SIMULATION_TYPE.HorizontalCurved && 0 != u) {
                            var gd = Ya, hd = Ab, Fb = []; arcLoop =
                                17; for (var ha = 0; ha < arcLoop; ha++)Fb[ha] = hd[ha]; for (ha = 0; ha < arcLoop; ha++)Fb[ha + 17] = gd[16 - ha]; for (var W = nb = Fb, Hc = [], Ga = 0, Ha = 32, Gb = 0; 16 > Gb; Gb++)Hc[Gb] = [{ x: W[Ga].x, y: W[Ga].y, z: W[Ga].z }, { x: W[Ga + 1].x, y: W[Ga + 1].y, z: W[Ga + 1].z }, { x: W[Ha].x, y: W[Ha].y, z: W[Ha].z }, { x: W[Ha + 1].x, y: W[Ha + 1].y, z: W[Ha + 1].z }], Ga++, Ha--; db = Hc; ob = 16
                        } else if (Gc == SIMULATION_TYPE.VerticalCurved && 0 != u) {
                            var K = ab, L = Eb, y = []; y[0] = K[16]; y[1] = L[16]; y[2] = L[15]; y[3] = L[14]; y[4] = L[13]; y[5] = L[12]; y[6] = L[11]; y[7] = L[10]; y[8] = L[9]; y[9] = L[8]; y[10] = L[7]; y[11] =
                                L[6]; y[12] = L[5]; y[13] = L[4]; y[14] = L[3]; y[15] = L[2]; y[16] = L[1]; y[17] = L[0]; y[18] = K[0]; y[19] = K[1]; y[20] = K[2]; y[21] = K[3]; y[22] = K[4]; y[23] = K[5]; y[24] = K[6]; y[25] = K[7]; y[26] = K[8]; y[27] = K[9]; y[28] = K[10]; y[29] = K[11]; y[30] = K[12]; y[31] = K[13]; y[32] = K[14]; y[33] = K[15]; var H = nb = y, Hb = [], Ia = 33, Ja = 2; Hb[0] = [{ x: H[0].x, y: H[0].y, z: H[0].z }, { x: H[1].x, y: H[1].y, z: H[1].z }, { x: H[2].x, y: H[2].y, z: H[2].z }, { x: H[33].x, y: H[33].y, z: H[33].z }]; for (var Ib = 1; 16 > Ib; Ib++)Hb[Ib] = [{ x: H[Ia].x, y: H[Ia].y, z: H[Ia].z }, { x: H[Ja].x, y: H[Ja].y, z: H[Ja].z },
                                { x: H[Ja + 1].x, y: H[Ja + 1].y, z: H[Ja + 1].z }, { x: H[Ia - 1].x, y: H[Ia - 1].y, z: H[Ia - 1].z }], Ja++, Ia--; db = Hb; ob = 16
                        } else { var eb = []; eb[0] = { x: 0, y: t, z: 0 }; eb[1] = { x: w, y: t, z: 0 }; eb[2] = { x: w, y: 0, z: 0 }; eb[3] = { x: 0, y: 0, z: 0 }; db = nb = eb } var fb = [], Jb = bc, Ic = ob, ya = db, id = p.x, jd = p.y, kd = p.z, Jc = [], ia = { x: 0, y: 0, z: 0 }, Kb = 0, T = { x: 0, y: 0, z: 0 }, Kc, Lc; Kb -= Ba; T = d.CalcRotationZXY(0, 0, Kb, id, jd, kd); T.x = f.x + 0; T.y = f.y + 0; T.z = f.z + Kb; for (var za = 0; 33 > za; za++) {
                            var U = 2E5; ia.x = Jb[za].x - T.x; ia.y = Jb[za].y - T.y; ia.z = Jb[za].z - T.z; U = Mc(U, T, ia, t, w); 0 == za && (Kc = U); if (1 ==
                                Ic) { var Lb = ya[0]; var Mb = ya[1]; var Nb = ya[2]; var Ob = ya[3]; U = pb(U, T, ia, Lb, Mb, Nb, Ob) } else for (var Ta = 0; Ta < Ic; Ta++)Lb = ya[Ta][0], Mb = ya[Ta][1], Nb = ya[Ta][2], Ob = ya[Ta][3], U = pb(U, T, ia, Lb, Mb, Nb, Ob); 0 == za && (Lc = U); 2E5 == U && (U = 0); Jc[za] = { x: T.x + ia.x * U, y: T.y + ia.y * U, z: T.z + ia.z * U }
                        } Kc == Lc ? g.SetIsCenterRayHitFrontScreen(!1) : g.SetIsCenterRayHitFrontScreen(!0); fb = Jc; if (0 < r) {
                            var Nc = [], qb = dc, Oc = ob, Aa = db, ld = p.x, md = p.y, nd = p.z, Pc = [], ja = { x: 0, y: 0, z: 0 }, Pb = 0, V = { x: 0, y: 0, z: 0 }; Pb -= Ba; V = d.CalcRotationZXY(0, 0, Pb, ld, md, nd); V.x = f.x + 0;
                            V.y = f.y + 0; V.z = f.z + Pb; for (var Ua = 0; Ua < qb.length; Ua++) { var Z = 2E5; ja.x = qb[Ua].x - V.x; ja.y = qb[Ua].y - V.y; ja.z = qb[Ua].z - V.z; Z = Mc(Z, V, ja, t, w); if (1 == Oc) { var Qb = Aa[0]; var Rb = Aa[1]; var Sb = Aa[2]; var Tb = Aa[3]; Z = pb(Z, V, ja, Qb, Rb, Sb, Tb) } else for (var Va = 0; Va < Oc; Va++)Qb = Aa[Va][0], Rb = Aa[Va][1], Sb = Aa[Va][2], Tb = Aa[Va][3], Z = pb(Z, V, ja, Qb, Rb, Sb, Tb); 2E5 == Z && (Z = 0); Pc[Ua] = { x: V.x + ja.x * Z, y: V.y + ja.y * Z, z: V.z + ja.z * Z } } Nc = Pc
                        } var Qc = [], rb = fb, gb = []; gb[0] = rb[1]; gb[1] = rb[9]; gb[2] = rb[17]; gb[3] = rb[25]; gb[4] = rb[5]; gb[5] = rb[21]; Qc = gb; var l = fb; if ($("#pj_place").val() ==
                            PJ_PLACE.Desktop) { var N = l[9].x - l[1].x; var O = l[9].x - l[1].x; var ka = 1; var la = 9; var ma = 1; var na = 9; for (var C = 0, z = 10; 18 > z; z++)N < l[z].x - l[32 - C].x && (N = l[z].x - l[32 - C].x, ka = 32 - C, la = z), O > l[z].x - l[32 - C].x && (O = l[z].x - l[32 - C].x, ma = 32 - C, na = z), C++ } else if ($("#pj_place").val() == PJ_PLACE.Ceiling) {
                                N = l[25].x - l[17].x; O = l[25].x - l[17].x; ka = 17; la = 25; ma = 17; na = 25; C = 0; for (z = 16; 9 < z; z--)N < l[26 + C].x - l[z].x && (N = l[26 + C].x - l[z].x, ka = z, la = 26 + C), O > l[26 + C].x - l[z].x && (O = l[26 + C].x - l[z].x, ma = z, na = 26 + C), C++; N < l[1].x - l[9].x && (N = l[1].x - l[9].x,
                                    ka = 9, la = 1); O > l[1].x - l[9].x && (O = l[1].x - l[9].x, ma = 9, na = 1)
                            } else if ($("#pj_place").val() == PJ_PLACE.PortClock) for (N = l[1].x - l[25].x, O = l[1].x - l[25].x, ka = 25, la = 1, ma = 25, na = 1, C = 0, z = 2; 10 > z; z++)N < l[z].x - l[24 - C].x && (N = l[z].x - l[24 - C].x, ka = 24 - C, la = z), O > l[z].x - l[24 - C].x && (O = l[z].x - l[24 - C].x, ma = 24 - C, na = z), C++; else if ($("#pj_place").val() == PJ_PLACE.PortUnClock) for (N = l[17].x - l[9].x, O = l[17].x - l[9].x, ka = 9, la = 17, ma = 9, na = 17, C = 0, z = 8; 0 < z; z--)N < l[18 + C].x - l[z].x && (N = l[18 + C].x - l[z].x, ka = z, la = 18 + C), O > l[18 + C].x - l[z].x && (O = l[18 +
                                C].x - l[z].x, ma = z, na = 18 + C), C++; var od = { max: N, maxLIndex: ka, maxRIndex: la, min: O, minLIndex: ma, minRIndex: na }; var m = fb; if ($("#pj_place").val() == PJ_PLACE.Desktop) { var P = m[1].y - m[25].y; var Q = m[1].y - m[25].y; var oa = 1; var pa = 25; var qa = 1; var ra = 25; for (var D = 0, A = 2; 10 > A; A++)P < m[A].y - m[25 - D].y && (P = m[A].y - m[25 - D].y, oa = A, pa = 25 - D), Q > m[A].y - m[25 - D].y && (Q = m[A].y - m[25 - D].y, qa = A, ra = 25 - D), D++ } else if ($("#pj_place").val() == PJ_PLACE.Ceiling) for (P = m[17].y - m[9].y, Q = m[17].y - m[9].y, oa = 17, pa = 9, qa = 17, ra = 9, D = 0, A = 18; 26 > A; A++)P < m[A].y -
                                    m[8 - D].y && (P = m[A].y - m[8 - D].y, oa = A, pa = 8 - D), Q > m[A].y - m[8 - D].y && (Q = m[A].y - m[8 - D].y, qa = A, ra = 8 - D), D++; else if ($("#pj_place").val() == PJ_PLACE.PortClock) { P = m[25].y - m[17].y; Q = m[25].y - m[17].y; oa = 25; pa = 17; qa = 25; ra = 17; D = 0; for (A = 26; 33 > A; A++)P < m[A].y - m[17 - D].y && (P = m[A].y - m[17 - D].y, oa = A, pa = 17 - D), Q > m[A].y - m[17 - D].y && (Q = m[A].y - m[17 - D].y, qa = A, ra = 17 - D), D++; P < m[1].y - m[9].y && (P = m[1].y - m[9].y, oa = 1, pa = 9); Q > m[1].y - m[9].y && (Q = m[1].y - m[9].y, qa = 1, ra = 9) } else if ($("#pj_place").val() == PJ_PLACE.PortUnClock) for (P = m[9].y - m[1].y,
                                        Q = m[9].y - m[1].y, oa = 9, pa = 1, qa = 9, ra = 1, D = 0, A = 10; 18 > A; A++)P < m[A].y - m[32 - D].y && (P = m[A].y - m[32 - D].y, oa = A, pa = 32 - D), Q > m[A].y - m[32 - D].y && (Q = m[A].y - m[32 - D].y, qa = A, ra = 32 - D), D++; var pd = { max: P, maxUIndex: oa, maxBIndex: pa, min: Q, minUIndex: qa, minBIndex: ra }; g.SetProjMinMaxWidth(od); g.SetProjMinMaxHeight(pd); g.SetPjBody(pjBodyPoint); g.SetFloor(Ya); g.SetCeiling(Ab); g.SetLWall(ab); g.SetRWall(Eb); g.SetScreen(nb); g.SetProjectionRay(fb); 0 < r && (g.SetProjectionLensShift(Nc), g.SetIsLensShiftArea(Vc)); $("#lock_size").prop("checked") ||
                                            (g.SetTeleScreenSize(Ca), g.SetWideScreenSize(sa), g.SetDistanceToScreen(Ka)); g.SetProjection4Corner(Qc); d.CalcReport()
                }; var cc = function (a, b, c, k, h, e, g, p, f, q, B, w, t, u, r, G) {
                    var n = []; b = d.CalcDiagonalFromDiatanceToScreen(a, b, c); var x = d.CalcScreenSizeWidthFromScreenSizeDiagonal(b, k, h); b = d.CalcScreenSizeHeightFromScreenSizeDiagonal(b, k, h); var F = k / h; var I = e / g; F = x * (F < I ? 1 : I / F); k /= h; e /= g; var Y = b * (k < e ? k / e : 1); e = -.5 * F + x * f; g = .5 * Y + b * p; a *= -1; k = .5 * F + x * f; h = .5 * Y + b * p; I = -.5 * F + x * f; Y = -.5 * Y + b * p; F = .5 * F + x * f; n[0] = { x: 0, y: 0, z: a };
                    n[0].x += x * f; n[0].y += b * p; p = (k - e) / 8; f = (g - Y) / 8; for (var v = 1; 33 > v; v++)1 <= v && 9 >= v ? (x = e + p * (v - 1), n[v] = { x: x, y: g, z: a }) : 9 < v && 17 > v ? (x = h - f * (v - 9), n[v] = { x: k, y: x, z: a }) : 17 <= v && 25 >= v ? (x = F - p * (v - 17), n[v] = { x: x, y: Y, z: a }) : 25 < v && (x = Y + f * (v - 25), n[v] = { x: I, y: x, z: a }); for (v = 0; 33 > v; v++)n[v].y += b * q, n[v].z += c, x = d.CalcRotationZXY(n[v].x, n[v].y, n[v].z, B, w, t), n[v] = x, n[v].z -= c, n[v].x += u, n[v].y += r, n[v].z += G; return n
                }, ec = function (a, b, c, k, h, e, g, p, f, q, B, w, t, u, r, G) {
                    e = [{ x: 0, y: 0, z: 0 }]; g = d.CalcDiagonalFromDiatanceToScreen(a, b, c); b = d.CalcScreenSizeWidthFromScreenSizeDiagonal(g,
                        k, h); k = d.CalcScreenSizeHeightFromScreenSizeDiagonal(g, k, h); g = -1 * a; for (a = 0; a < u; a++)for (var n = 0; 32 > n; n++) { var x = a == u - 1 ? 0 : a + 1; var F = n / 31; h = r[a].x * (1 - F) + r[x].x * F; x = r[a].y * (1 - F) + r[x].y * F; h *= b; x *= k; e[32 * a + n] = { x: h, y: x, z: g } } for (a = 0; a < 32 * u; a++)e[a].y += k * G, e[a].z += c, r = d.CalcRotationZXY(e[a].x, e[a].y, e[a].z, p, f, q), e[a] = r, e[a].z -= c, e[a].x += B, e[a].y += w, e[a].z += t; return e
                }; d.CalcPanelDiagRatioByUserAspect = function (a, b, c, k) {
                    var d = a / b; k = c / k; c = $("#lenses").val(); d < k && "ET-C1U200" != c ? (c = 1, d /= k) : (c = k / d, d = 1); c *= a; d *=
                        b; return Math.sqrt(c * c + d * d) / Math.sqrt(a * a + b * b)
                }; d.CalcCircleBy3Point = function (a, b, c) { var d = a.x * (2 * c.y - 2 * b.y) - 2 * b.x * c.y + 2 * c.x * b.y + (2 * b.x - 2 * c.x) * a.y; if (!(1E-6 >= Math.abs(d))) { var h = -(a.y * (c.y * c.y - b.y * b.y + c.x * c.x - b.x * b.x) + b.y * (-c.y * c.y - c.x * c.x) + b.y * b.y * c.y + b.x * b.x * c.y + a.y * a.y * (b.y - c.y) + a.x * a.x * (b.y - c.y)); h /= d; b = a.x * (c.y * c.y - b.y * b.y + c.x * c.x - b.x * b.x) + b.x * (-c.y * c.y - c.x * c.x) + b.x * b.x * c.x + b.y * b.y * c.x + a.y * a.y * (b.x - c.x) + a.x * a.x * (b.x - c.x); b /= d; return { x: h, y: b, rs2: (h - a.x) * (h - a.x) + (b - a.y) * (b - a.y) } } }; d.CalcCircleCenterPointAndDepth =
                    function (a, b) { var c = Math.abs(b); if (!(Math.sqrt(a.x * a.x) > 2 * c)) { var d = a.x / 2; a = Math.sqrt(c * c - a.x / 2 * (a.x / 2)); 0 > b && (a *= -1); return { x: d, y: a, depth: b - a } } }; var tc = function (a, b, c, d, h) { b = []; d = Math.sqrt(a.rs2); var e = c.x; c = Math.acos(e / d); thRange = Math.acos(-1 * e / d) - c; thSplit = thRange / 16; for (e = 0; 17 > e; e++) { var k = Math.cos(c + thSplit * e), g = Math.sin(c + thSplit * e); 0 < h && (g *= -1); k *= d; g *= d; k += a.x; g += a.y; b[e] = { x: k, y: g } } return b }, Mc = function (a, b, c, d, h) {
                        if (0 != c.y) { var e = (0 - b.y) / c.y; 0 < e && e < a && (a = e); e = (d - b.y) / c.y; 0 < e && e < a && (a = e) } 0 !=
                            c.x && (e = (0 - b.x) / c.x, 0 < e && e < a && (a = e), e = (h - b.x) / c.x, 0 < e && e < a && (a = e)); return a
                    }, pb = function (a, b, c, d, h, e, g) { var k = a; h = sb(a, b, c, d, h, e); h < a && (k = h); h = sb(a, b, c, d, e, g); h < a && (k = h); return k }, sb = function (a, b, c, d, h, e) {
                        var k = a; var g = h.x - d.x, f = h.y - d.y, q = h.z - d.z; if (1E-6 > Math.abs(g) && 1E-6 > Math.abs(f) && 1E-6 > Math.abs(q)) return a; var B = e.x - d.x; var w = e.y - d.y, t = e.z - d.z; if (1E-6 > Math.abs(B) && 1E-6 > Math.abs(w) && 1E-6 > Math.abs(t)) return a; var u = e.y - h.y, r = e.z - h.z; if (1E-6 > Math.abs(e.x - h.x) && 1E-6 > Math.abs(u) && 1E-6 > Math.abs(r)) return a;
                        r = c.y * t - c.z * w; var G = c.z * B - c.x * t, n = c.x * w - c.y * B; h = g * r + f * G + q * n; if (1E-6 > Math.abs(h)) return a; h = 1 / h; e = b.x - d.x; u = b.y - d.y; b = b.z - d.z; d = (e * r + u * G + b * n) * h; if (-1E-6 > d || 1.000001 < d) return a; r = u * q - b * f; q = b * g - e * q; g = e * f - u * g; c = (c.x * r + c.y * q + c.z * g) * h; if (0 > c || 1 < d + c) return a; B = (B * r + w * q + t * g) * h; 1E-6 < B && B < a && (k = B); return k
                    }, Wb = function (a, b, c, k, h) { a = d.CalcDiagonalFromDiatanceToScreen(a, b, c); b = d.CalcScreenSizeWidthFromScreenSizeDiagonal(a, k, h); k = d.CalcScreenSizeHeightFromScreenSizeDiagonal(a, k, h); return { diagonal: a, width: b, height: k } };
    d.CalcReport = function () { g.GetWideScreenSize(); var a = g.GetBright(), b = g.GetBrightCenter(), c = g.GetScreenGain(), d = g.GetAmbientLight(), h = g.GetPjContrastSpecValue(), e = g.GetPjOrigin(), x = g.GetProjectionRay(), p = g.GetLensShift(), f = g.GetLensShiftOffsetV(); p.v += f; f = g.GetNativeAspect(); var q = g.GetParamABZoom(); a = 0 == b ? tb(a, e, x[0], p.v, p.h, f.w, f.h, q.A, q.B) : tb(b, e, x[0], p.v, p.h, f.w, f.h, q.A, q.B); c = c * a / Math.PI; d = (a + d) / (a / h + d); g.SetCenterLux(a); g.SetNits(c); g.SetContrast(d) }; var tb = function (a, b, c, k, h, e, g, p, f) {
        var q = b.x;
        var x = b.y; b = b.z; var w = c.x, t = c.y; c = c.z; q = Math.sqrt((q - w) * (q - w) + (x - t) * (x - t) + (b - c) * (b - c)); c = d.CalcDiagonalFromDiatanceToScreen(q, p, f); x = d.CalcScreenSizeWidthFromScreenSizeDiagonal(c, e, g); c = d.CalcScreenSizeHeightFromScreenSizeDiagonal(c, e, g); h /= q / x; k /= q / c; q *= Math.cos(Math.atan(Math.sqrt(h * h + k * k))); f = d.CalcDiagonalFromDiatanceToScreen(q, p, f); p = d.CalcScreenSizeWidthFromScreenSizeDiagonal(f, e, g); e = d.CalcScreenSizeHeightFromScreenSizeDiagonal(f, e, g); return a / (p / 1E3 * (e / 1E3))
    }; d.CalcXYZtoCanvasXY = function (a,
        b, c, d, h, e, g, p, f, q) { var k = b * Math.cos(d) + c * Math.sin(d); a = -(-b * Math.sin(d) + c * Math.cos(d)) * Math.sin(h) + a * Math.cos(h); return { x: (-k * Math.sin(e) + a * Math.cos(e)) * p + f, y: g - ((k * Math.cos(e) + a * Math.sin(e)) * p + q) } }; d.CalcTriangleCone = function (a, b, c, g) {
            for (var h = [[], [], [], [], [], []], e = 30 / 180 * Math.PI, k = 0 * Math.PI, p = (2 * Math.PI - k) / 64, f = 0, q = [], B = [], w = [], t = k; !(64 < f); t += p) {
                var u = g * Math.cos(t) * Math.sin(e), r = a - c, G = g * Math.sin(t) * Math.sin(e); B[f] = { x: u, y: r, z: G }; q[f] = d.CalcRotationZXY(u, r, G, 0, 0, 90); w[f] = d.CalcRotationZXY(u, r, G,
                    90, 0, 0); f++
            } t = { x: a, y: 0, z: 0 }; u = { x: 0, y: a, z: 0 }; r = { x: 0, y: 0, z: 1.2 * a }; a = 1.2 * a - a; for (f = 0; 64 > f; f++)h[0].push([t, q[f], q[f + 1]]); for (f = 0; 64 > f; f++)h[1].push([u, B[f], B[f + 1]]); for (f = 0; 64 > f; f++)h[2].push([r, w[f], w[f + 1]]); f = 0; for (t = k; !(64 < f); t += p)u = g * Math.cos(t) * Math.sin(e), r = b - -c, G = g * Math.sin(t) * Math.sin(e), B[f] = { x: u, y: r, z: G }, q[f] = d.CalcRotationZXY(u, r, G, 0, 0, 90), w[f] = d.CalcRotationZXY(u, r, G, 90, 0, 0), f++; c = { x: b, y: 0, z: 0 }; g = { x: 0, y: b, z: 0 }; b = { x: 0, y: 0, z: b - a }; for (f = 0; 64 > f; f++)h[3].push([c, q[f], q[f + 1]]); for (f = 0; 64 > f; f++)h[4].push([g,
                B[f], B[f + 1]]); for (f = 0; 64 > f; f++)h[5].push([b, w[f], w[f + 1]]); return h
        }; d.CalcColumn = function (a, b, c, g) {
            for (var h = [[], [], [], [], [], []], e = 30 / 180 * Math.PI, k = 0 * Math.PI, p = (2 * Math.PI - k) / 64, f = 0, q = [], B = [], w = [], t = [], u = [], r = [], G = k; !(64 < f); G += p) { var n = g * Math.cos(G) * Math.sin(e), X = a - c, F = a, I = g * Math.sin(G) * Math.sin(e); B[f] = { x: n, y: X, z: I }; u[f] = { x: n, y: F, z: I }; q[f] = d.CalcRotationZXY(n, X, I, 0, 0, 90); t[f] = d.CalcRotationZXY(n, F, I, 0, 0, 90); w[f] = d.CalcRotationZXY(n, X, I, 90, 0, 0); r[f] = d.CalcRotationZXY(n, F, I, 90, 0, 0); f++ } for (a = 0; 64 > a; a++)h[0].push([q[a],
            q[a + 1], t[a], t[a + 1]]); for (a = 0; 64 > a; a++)h[1].push([B[a], B[a + 1], u[a], u[a + 1]]); for (a = 0; 64 > a; a++)h[2].push([w[a], w[a + 1], r[a], r[a + 1]]); f = 0; for (G = k; !(64 < f); G += p)n = g * Math.cos(G) * Math.sin(e), X = b - c, F = b, I = g * Math.sin(G) * Math.sin(e), B[f] = { x: n, y: X, z: I }, u[f] = { x: n, y: F, z: I }, q[f] = d.CalcRotationZXY(n, X, I, 0, 0, 90), t[f] = d.CalcRotationZXY(n, F, I, 0, 0, 90), w[f] = d.CalcRotationZXY(n, X, I, 90, 0, 0), r[f] = d.CalcRotationZXY(n, F, I, 90, 0, 0), f++; for (a = 0; 64 > a; a++)h[3].push([q[a], q[a + 1], t[a], t[a + 1]]); for (a = 0; 64 > a; a++)h[4].push([B[a], B[a +
                1], u[a], u[a + 1]]); for (a = 0; 64 > a; a++)h[5].push([w[a], w[a + 1], r[a], r[a + 1]]); return h
        }; return hb
}();
